var StartView=Backbone.View.extend({el:"body",events:{"click .start":"startGame"},initialize:function(){this.render()},startGame:function(){var a=this.getNameValueCookies("login");a?(tableModule.set({login:a}),createOrJoinView.render()):loginView.render()},getNameValueCookies:function(a){var b="; "+document.cookie,c=b.split("; "+a+"=");return 2==c.length?c.pop().split(";").shift():void 0},render:function(){this.$el.append('<div class="site-wrapper"><div class="site-wrapper-inner"><div class="cover-container"><div class="masthead clearfix"><div class="inner"><h3 class="masthead-brand">Planning Poker</h3></div></div><div class="inner cover"><h1 class="cover-heading">Planning Poker</h1><p class="lead">A realtime Planning Poker application for distributed Agile teams</p><p class="lead"><a href="#" class="btn btn-lg btn-success start submit">Start</a></p></div><div class="mastfoot"><div class="inner"><p>Created by <a href="https://twitter.com/onikiienko">@onikiienko</a></p></div></div></div></div></div>')}});startView=new StartView;var LoginView=Backbone.View.extend({el:".inner.cover",render:function(){this.$el.html('<div class="form-signin login" role="form"><h2 class="form-signin-heading">Please sign in</h2><input type="login" class="form-control loginInput" placeholder="Login" required autofocus><div class="checkbox"><label><input type="checkbox" value="remember-me" class="loginCheckBox"> Remember me</label></div><button class="btn btn-lg btn-success loginBtn" type="submit">Sign in</button></div>')},events:{"click .loginBtn":"loginSubmit"},loginSubmit:function(){var a=$(".loginInput").val();tableModule.set({login:a}),$(".loginCheckBox").prop("checked")&&(document.cookie="login="+a),createOrJoinView.render()}});loginView=new LoginView;var CreateOrJoinView=Backbone.View.extend({el:".inner.cover",events:{"click .enterRoomBtn":"enterRoom"},render:function(){this.$el.html('<h1 class="cover-heading">Enter to room</h1><p class="lead">Create your own room or join other.</p><input type="default" class="form-control roomNameInput" placeholder="Room name" required autofocus></p><br><div class="currencyType"><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="standardCurrency" checked>Standard</label></div><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="tShirtCurrency">T-shirt</label></div><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio3" value="fibonacciCurrency">Fibonacci</label></div></div><br><p class="lead"><button href="#" class="btn btn-lg btn-success enterRoomBtn submit">Enter room</button></p>')},enterRoom:function(){tableModule.set({room:$(".roomNameInput").val()});var a="/"+tableModule.toJSON().room,b=$("input:checked").prop("value"),c=tableModule.toJSON().login;socket.emit("enter room",a,b,c),socket=io(a),this.socketInit()},socketInit:function(){socket.on("connectionReady",function(a,b,c){gamersListCollection.set(c),cardsToChooseCollection.set(a),tableView.render(),tableView.renderCardsToChoose(),tableView.renderGamersList(),b[0]&&(gameZoneCollection.set(b),tableView.renderGameZone())}),socket.on("updateTable",function(a,b){gameZoneCollection.set(a),b&&gamersListCollection.set(b),tableView.renderGameZone(),tableView.renderGamersList()})}});createOrJoinView=new CreateOrJoinView;var TableView=Backbone.View.extend({el:".inner.cover",events:{"click .cardsToChooseView":"chooseACard","click .restartRoundBtn":"restartRound","click .flipCardsBtn":"flipCards"},render:function(){return this.$el.html('<h3 class="masthead-brand tableNameView"></h3><br><h3 class="masthead-brand taskNameView"></h3><br><div class="table row"><div class="gameZoneView row"></div><button href="#" class="btn btn-lg btn-primary restartRoundBtn">Restart task</button><button href="#" class="btn btn-lg btn-primary flipCardsBtn">Flip cards</button></div><br><div class="cardsToChooseView row"></div><div class="chatAndTaskList row"><ul class="list-group gamersListView"></ul><div class="taskListView row"></div><div class="chatView row"></div></div>'),$(".tableNameView").append(this.tempTableName(tableModule.toJSON())),this},renderGameZone:function(){return $(".gameZoneView").html(this.tempGameZone(gameZoneCollection.toJSON())),this},renderCardsToChoose:function(){return $(".cardsToChooseView").append(this.tempCardsToChoose(cardsToChooseCollection.toJSON())),this},renderGamersList:function(){return $(".gamersListView").html(this.tempGamersList(gamersListCollection.toJSON())),this},tempGameZone:_.template("<%for(var gamerModel in data) { %><div class='col-xs-6 col-md-3'><div class='thumbnail' data='<%= data[gamerModel].name %>'><%= data[gamerModel].name %><br><%= data[gamerModel].number.name %>(<%= data[gamerModel].number.data %>)</div></div><% } %>",{variable:"data"}),tempCardsToChoose:_.template("<%for(var card in data) { %><div class='col-xs-6 col-md-3'><% for(var name in data[card]) { %><div class='thumbnail' data='<%= data[card][name] %>'><%= name %></div><% } %></div><% } %>",{variable:"data"}),tempTableName:_.template("Room: <%= data.room %>, Login: <%= data.login %>",{variable:"data"}),tempGamersList:_.template("<%for(var gamer in data) { %><li class='list-group-item'><%= data[gamer].name %></li><% } %>",{variable:"data"}),chooseACard:function(a){var b=a.target.getAttribute("data"),c=a.target.innerText;socket.emit("vote",new Backbone.Model({name:tableModule.toJSON().login,number:{name:c,data:b}}))},restartRound:function(){socket.emit("restart")}});tableView=new TableView;