function hasScrolled(){var a=$(this).scrollTop();Math.abs(lastScrollTop-a)<=delta||(a>lastScrollTop&&a>navbarHeight?$(".headerDiv").removeClass("nav-down").addClass("nav-up"):a+$(window).height()<$(document).height()&&$(".headerDiv").removeClass("nav-up").addClass("nav-down"),lastScrollTop=a)}var StartView=Backbone.View.extend({el:"body",events:{"click .start":"startGame"},initialize:function(){socket.on("numberOfRooms",function(a){$(".roomsNumberView").html("It has been created "+a+" rooms.")}),this.render()},startGame:function(){var a=this.getNameValueCookies("login");a?(tableModule.set({login:a}),createOrJoinView.render()):loginView.render()},getNameValueCookies:function(a){var b="; "+document.cookie,c=b.split("; "+a+"=");return 2==c.length?c.pop().split(";").shift():void 0},render:function(){this.$el.append('<nav class="navbar navbar-inverse navbar-fixed-top headerDiv" role="navigation"><div class="container"><div class="navbar-header"><a class="navbar-brand" href="#">Scrum Poker</a></div></div></nav><div class="contentDiv text-center"><div class="jumbotron vcenter"><div class="container"><h1 class="cover-heading">Join Us!</h1><p class="lead roomsNumberView"></p><p class="lead">A realtime Planning Poker application for distributed Agile teams</p><p class="lead"><a href="#" class="btn btn-lg btn-success start submit">Start</a></p></div></div></div><div class="footerDiv footer"></div>')}});startView=new StartView;var LoginView=Backbone.View.extend({el:".contentDiv",render:function(){this.$el.html('<div class="loginDiv jumbotron vcenter" role="form"><div class="container"><h2>Please sign in</h2><input type="text" class="loginInput" placeholder="Login" required autofocus="true"><div class="checkbox"><label><input type="checkbox" value="remember-me" class="loginCheckBox"> Remember me</label></div><button class="btn btn-lg btn-success loginBtn" type="submit">Sign in</button></div></div>')},events:{"click .loginBtn":"loginSubmit"},loginSubmit:function(){var a=$(".loginInput").val();tableModule.set({login:a}),$(".loginCheckBox").prop("checked")&&(document.cookie="login="+a),createOrJoinView.render()}});loginView=new LoginView;var CreateOrJoinView=Backbone.View.extend({el:".contentDiv",events:{"click .enterRoomBtn":"enterRoom"},render:function(){this.$el.html('<div class="jumbotron vcenter" role="form"><div class="container"><h1>Enter to room</h1><p>Create your own room or join other.</p><input type="text" class="roomNameInput" placeholder="Room name" required autofocus="true"><br><br><div class="currencyType"><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="standardCurrency" checked>Standard</label></div><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="tShirtCurrency">T-shirt</label></div><div class="radio-inline"><label><input type="radio" name="inlineRadioOptions" id="inlineRadio3" value="fibonacciCurrency">Fibonacci</label></div></div><br><p><button href="#" class="btn btn-lg btn-success enterRoomBtn submit">Enter room</button></p></div></div>')},enterRoom:function(){tableModule.set({room:$(".roomNameInput").val()});var a="/"+tableModule.toJSON().room,b=$("input:checked").prop("value"),c=tableModule.toJSON().login;socket.emit("enter room",a,b,c),socket=io(a),this.socketInit()},socketInit:function(){socket.on("connectionReady",function(a,b,c){gamersListCollection.set(c),cardsToChooseCollection.set(a),tableView.render(),tableView.renderCardsToChoose(),tableView.renderGamersList(),b[0]&&(gameZoneCollection.set(b),tableView.renderGameZone())}),socket.on("updateTable",function(a,b){gameZoneCollection.set(a),b&&gamersListCollection.set(b),tableView.renderGameZone(),tableView.renderGamersList()}),socket.on("chat message",function(a,b){tableView.renderMessage(a,b)})}});createOrJoinView=new CreateOrJoinView;var TableView=Backbone.View.extend({el:".contentDiv",events:{"click .cardsToChooseView":"chooseACard","click .restartRoundBtn":"restartRound","click .flipCardsBtn":"flipCards","click .sendMessage":"sendMessage"},render:function(){return this.$el.html('<div class="contentDiv text-center"><div class="jumbotron vcenter" role="form"><div class="container"><div class="rightGameView"><div class="taskListView">Task list<div class="taskList"></div><input type="text" class="taskInput" placeholder="Task name"><button href="#" class="btn btn-lg btn-primary addTask">Add</button></div><div class="taskResultsListView">Vote results<div class="taskList"></div></div><div class="chatView">Chat<div class="messages"></div><input type="text" class="chatInput" placeholder="Message" required="" autofocus="true"><button href="#" class="btn btn-lg btn-primary sendMessage">Send</button></div></div><div class="leftGameView"><div class="gamersListView">Gamers:</div><div class="tableNameView"></div><div class="taskNameView"><p>Task#1</p></div><div class="table"><button href="#" class="btn btn-lg btn-primary restartRoundBtn">Restart task</button><button href="#" class="btn btn-lg btn-primary flipCardsBtn">Flip cards</button><div class="gameZoneView"></div></div><div class="cardsToChooseView"></div></div></div></div></div>'),$(".tableNameView").append(this.tempTableName(tableModule.toJSON())),this},renderMessage:function(a,b){return $("<div/>",{text:b+" : "+a}).appendTo(".messages"),$(".messages").animate({scrollTop:$(document).height()},"slow"),this},renderGameZone:function(){return $(".gameZoneView").html(this.tempGameZone(gameZoneCollection.toJSON())),this},renderCardsToChoose:function(){return $(".cardsToChooseView").append(this.tempCardsToChoose(cardsToChooseCollection.toJSON())),this},renderGamersList:function(){return $(".gamersListView").html(this.tempGamersList(gamersListCollection.toJSON())),this},tempGameZone:_.template("<%for(var gamerModel in data) { %><div class='thumbnail' data='<%= data[gamerModel].name %>'><%= data[gamerModel].name %><br><%= data[gamerModel].number.name %>(<%= data[gamerModel].number.data %>)</div><% } %>",{variable:"data"}),tempCardsToChoose:_.template("<p>Choose a card:</p><%for(var card in data) { %><% for(var name in data[card]) { %><div class='cardToChoose thumbnail' data='<%= data[card][name] %>'><%= name %></div><% } %><% } %>",{variable:"data"}),tempTableName:_.template("<div class='tableRoomView'><h3>Room: <%= data.room %></h3></div><div class='tableLoginView'><h3>Login: <%= data.login %></h3></div>",{variable:"data"}),tempGamersList:_.template("<p>List of Gamers:</p><%for(var gamer in data) { %><div><%= data[gamer].name %></div><% } %>",{variable:"data"}),sendMessage:function(){var a=$(".chatInput").val(),b=tableModule.toJSON().login;return socket.emit("chat message",a,b),$(".chatInput").val(""),!1},chooseACard:function(a){var b=a.target.getAttribute("data"),c=a.target.getAttribute("class");if("cardToChoose thumbnail"==c){var d=a.target.innerText;socket.emit("vote",new Backbone.Model({name:tableModule.toJSON().login,number:{name:d,data:b}}))}},restartRound:function(){socket.emit("restart")}});tableView=new TableView;var didScroll=!1,lastScrollTop=0,delta=5,navbarHeight=$(".headerDiv").outerHeight();$(window).scroll(function(){didScroll=!0}),setInterval(function(){didScroll&&(hasScrolled(),didScroll=!1)},50);