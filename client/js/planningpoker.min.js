function hasScrolled(){var a=$(this).scrollTop();Math.abs(lastScrollTop-a)<=delta||(a>lastScrollTop&&a>navbarHeight?$(".headerDiv").removeClass("nav-down").addClass("nav-up"):a+$(window).height()<$(document).height()&&$(".headerDiv").removeClass("nav-up").addClass("nav-down"),lastScrollTop=a)}var StartView=Backbone.View.extend({el:".startView",events:{"click .start":"startGame"},initialize:function(){socket.on("numberOfRooms",function(a){$(".roomsNumberView").html("It has been created "+a+" rooms.")}),this.render()},render:function(){$(".loginView, .createOrJoinView, .tableView, .startView").css("display","none"),this.$el.css("display","block")},startGame:function(){var a=this.getNameValueCookies("login");a?(tableModule.set({login:a}),createOrJoinView.render()):loginView.render()},getNameValueCookies:function(a){var b="; "+document.cookie,c=b.split("; "+a+"=");return 2==c.length?c.pop().split(";").shift():void 0}});startView=new StartView;var LoginView=Backbone.View.extend({el:".loginView",render:function(){$(".loginView, .createOrJoinView, .tableView, .startView").css("display","none"),this.$el.css("display","block")},events:{"click .loginBtn":"loginSubmit"},loginSubmit:function(){var a=$(".loginInput").val();tableModule.set({login:a}),$(".loginCheckBox").prop("checked")&&(document.cookie="login="+a),window.location.hash.substring(2)?createOrJoinView.joinRoom(window.location.hash.substring(1)):createOrJoinView.render()}});loginView=new LoginView;var CreateOrJoinView=Backbone.View.extend({el:".createOrJoinView",events:{"click .enterRoomBtn":"enterRoom"},isNewer:!0,render:function(){$(".loginView, .createOrJoinView, .tableView, .startView").css("display","none"),this.$el.css("display","block")},enterRoom:function(){tableModule.set({room:$(".roomNameInput").val()});var a="/"+tableModule.toJSON().room,b=$("input:checked").prop("value"),c=tableModule.toJSON().login;socket.emit("enter room",a,b,c),socket=io(a),this.socketInit(),window.location.hash=a},joinRoom:function(a){tableModule.set({room:a.substring(1)});var b=tableModule.toJSON().login;socket.emit("enter room",a,void 0,b),socket=io(a),this.socketInit()},socketInit:function(){var a=this;socket.on("connectionReady",function(b,c,d){a.isNewer&&(tableView.render(),cardsToChooseCollection.set(b),tableView.renderCardsToChoose(),c.length&&(gameZoneCollection.set(c),tableView.renderGameZone()),a.isNewer=!1),gamersListCollection.set(d),tableView.renderGamersList()}),socket.on("updateTable",function(a,b){gameZoneCollection.set(a),b&&gamersListCollection.set(b),tableView.renderGameZone(),tableView.renderGamersList()}),socket.on("chat message",function(a,b){tableView.renderMessage(a,b)})}});createOrJoinView=new CreateOrJoinView;var TableView=Backbone.View.extend({el:".tableView",events:{"click .cardsToChooseView":"chooseACard","click .restartRoundBtn":"restartRound","click .flipCardsBtn":"flipCards","click .sendMessage":"sendMessage"},render:function(){return $(".loginView, .createOrJoinView, .tableView, .startView").css("display","none"),this.$el.css("display","block"),$(".tableNameView").append(this.tempTableName(tableModule.toJSON())),this},renderMessage:function(a,b){return $("<div/>",{text:b+" : "+a}).appendTo(".messages"),$(".messages").animate({scrollTop:$(document).height()},"slow"),this},renderGameZone:function(){return $(".gameZoneView").html(this.tempGameZone(gameZoneCollection.toJSON())),this},renderCardsToChoose:function(){return $(".cardsToChooseView").append(this.tempCardsToChoose(cardsToChooseCollection.toJSON())),this},renderGamersList:function(){return $(".gamersListView").html(this.tempGamersList(gamersListCollection.toJSON())),this},tempGameZone:_.template("<%for(var gamerModel in data) { %><div class='thumbnail' data='<%= data[gamerModel].name %>'><%= data[gamerModel].name %><br><%= data[gamerModel].number.name %>(<%= data[gamerModel].number.data %>)</div><% } %>",{variable:"data"}),tempCardsToChoose:_.template("<p>Choose a card:</p><%for(var card in data) { %><% for(var name in data[card]) { %><div class='cardToChoose thumbnail' data='<%= data[card][name] %>'><%= name %></div><% } %><% } %>",{variable:"data"}),tempTableName:_.template("<div class='tableRoomView'><h3>Room: <%= data.room %></h3></div><div class='tableLoginView'><h3>Login: <%= data.login %></h3></div>",{variable:"data"}),tempGamersList:_.template("<p>List of Gamers:</p><%for(var gamer in data) { %><div><%= data[gamer].name %></div><% } %>",{variable:"data"}),sendMessage:function(){var a=$(".chatInput").val(),b=tableModule.toJSON().login;return socket.emit("chat message",a,b),$(".chatInput").val(""),!1},chooseACard:function(a){var b=a.target.getAttribute("data"),c=a.target.getAttribute("class");if("cardToChoose thumbnail"==c){var d=a.target.innerText;socket.emit("vote",new Backbone.Model({name:tableModule.toJSON().login,number:{name:d,data:b}}))}},restartRound:function(){socket.emit("restart")}});tableView=new TableView;var didScroll=!1,lastScrollTop=0,delta=5,navbarHeight=$(".headerDiv").outerHeight();$(window).scroll(function(){didScroll=!0}),setInterval(function(){didScroll&&(hasScrolled(),didScroll=!1)},50);